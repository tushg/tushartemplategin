sequenceDiagram
    participant Client
    participant MessageCatalogService
    participant Cache
    participant FileSystem
    participant Logger
    
    Note over Client,Logger: Message Retrieval Sequence
    
    Client->>MessageCatalogService: GetMessage(code, language)
    Note over Client,MessageCatalogService: Request message by code and language
    
    MessageCatalogService->>MessageCatalogService: Check if language specified
    alt Language not specified
        MessageCatalogService->>MessageCatalogService: Use default language
    end
    
    MessageCatalogService->>Cache: Check cache for language
    alt Cache Hit
        Cache-->>MessageCatalogService: Return cached message
        MessageCatalogService-->>Client: Return Message
    else Cache Miss
        MessageCatalogService->>FileSystem: Read JSON file
        FileSystem-->>MessageCatalogService: Return file content
        
        MessageCatalogService->>MessageCatalogService: Parse JSON
        alt Parse Error
            MessageCatalogService->>Logger: Log parse error
            MessageCatalogService-->>Client: Return AppError
        else Parse Success
            MessageCatalogService->>MessageCatalogService: Find message by code
            alt Message Not Found
                MessageCatalogService->>Logger: Log warning
                MessageCatalogService-->>Client: Return AppError
            else Message Found
                MessageCatalogService->>Cache: Update cache
                MessageCatalogService-->>Client: Return Message
            end
        end
    end
    
    Note over Client,Logger: Catalog Reload Sequence
    
    Client->>MessageCatalogService: ReloadCatalog()
    Note over Client,MessageCatalogService: Trigger catalog reload
    
    MessageCatalogService->>FileSystem: Scan directory for JSON files
    FileSystem-->>MessageCatalogService: Return file list
    
    loop For each language file
        MessageCatalogService->>FileSystem: Read JSON file
        FileSystem-->>MessageCatalogService: Return file content
        MessageCatalogService->>MessageCatalogService: Parse JSON
        MessageCatalogService->>MessageCatalogService: Create Message objects
    end
    
    MessageCatalogService->>Cache: Update cache with all messages
    MessageCatalogService->>Logger: Log reload success
    MessageCatalogService-->>Client: Return success
    
    Note over Client,Logger: Health Check Sequence
    
    Client->>MessageCatalogService: HealthCheck()
    Note over Client,MessageCatalogService: Check service health
    
    MessageCatalogService->>FileSystem: Scan directory for JSON files
    FileSystem-->>MessageCatalogService: Return file list
    
    alt No Languages Found
        MessageCatalogService->>Logger: Log error
        MessageCatalogService-->>Client: Return health check error
    else Languages Found
        MessageCatalogService->>Logger: Log success
        MessageCatalogService-->>Client: Return success
    end
    
    Note over Client,Logger: Error Handling Sequence
    
    Client->>MessageCatalogService: GetMessage(invalid_code, lang)
    Note over Client,MessageCatalogService: Request invalid message code
    
    MessageCatalogService->>FileSystem: Read JSON file
    FileSystem-->>MessageCatalogService: Return file content
    
    MessageCatalogService->>MessageCatalogService: Parse JSON
    MessageCatalogService->>MessageCatalogService: Find message by code
    
    alt Message Not Found
        MessageCatalogService->>Logger: Log warning with context
        MessageCatalogService->>MessageCatalogService: Create AppError with details
        MessageCatalogService-->>Client: Return AppError
    end
