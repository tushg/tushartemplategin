sequenceDiagram
    participant Client
    participant MessageCatalogService
    participant FileSystem
    participant Logger
    participant AppError
    
    Note over Client,AppError: File Not Found Error Sequence
    
    Client->>MessageCatalogService: GetMessage(code, "es")
    Note over Client,MessageCatalogService: Request Spanish message (file doesn't exist)
    
    MessageCatalogService->>FileSystem: Check if file exists
    FileSystem-->>MessageCatalogService: File not found
    
    MessageCatalogService->>AppError: Create AppError
    Note over AppError: ErrCodeNotFound, "Language file not found"
    
    MessageCatalogService->>Logger: Log error with context
    MessageCatalogService-->>Client: Return AppError
    
    Note over Client,AppError: JSON Parse Error Sequence
    
    Client->>MessageCatalogService: GetMessage(code, "en")
    Note over Client,MessageCatalogService: Request English message (malformed JSON)
    
    MessageCatalogService->>FileSystem: Read JSON file
    FileSystem-->>MessageCatalogService: Return malformed JSON content
    
    MessageCatalogService->>MessageCatalogService: Attempt to parse JSON
    Note over MessageCatalogService: JSON parsing fails
    
    MessageCatalogService->>AppError: Create AppError
    Note over AppError: ErrCodeBadRequest, "Failed to parse language file"
    
    MessageCatalogService->>Logger: Log error with context
    MessageCatalogService-->>Client: Return AppError
    
    Note over Client,AppError: Message Not Found Error Sequence
    
    Client->>MessageCatalogService: GetMessage("INVALID_CODE", "en")
    Note over Client,MessageCatalogService: Request non-existent message code
    
    MessageCatalogService->>FileSystem: Read JSON file
    FileSystem-->>MessageCatalogService: Return valid JSON content
    
    MessageCatalogService->>MessageCatalogService: Parse JSON successfully
    MessageCatalogService->>MessageCatalogService: Search for message code
    
    alt Message Code Not Found
        MessageCatalogService->>Logger: Log warning with context
        MessageCatalogService->>AppError: Create AppError with details
        Note over AppError: ErrCodeNotFound, "Message not found", details
        MessageCatalogService-->>Client: Return AppError
    end
    
    Note over Client,AppError: Directory Scan Error Sequence
    
    Client->>MessageCatalogService: ListAvailableLanguages()
    Note over Client,MessageCatalogService: Request available languages
    
    MessageCatalogService->>FileSystem: Scan directory for JSON files
    FileSystem-->>MessageCatalogService: Directory access error
    
    MessageCatalogService->>AppError: Create AppError
    Note over AppError: ErrCodeInternalServer, "Failed to scan catalog directory"
    
    MessageCatalogService->>Logger: Log error with context
    MessageCatalogService-->>Client: Return AppError
    
    Note over Client,AppError: Health Check Error Sequence
    
    Client->>MessageCatalogService: HealthCheck()
    Note over Client,MessageCatalogService: Check service health
    
    MessageCatalogService->>FileSystem: Scan directory for JSON files
    FileSystem-->>MessageCatalogService: Return empty file list
    
    alt No Languages Available
        MessageCatalogService->>Logger: Log error
        MessageCatalogService->>MessageCatalogService: Create error message
        MessageCatalogService-->>Client: Return health check error
    end
    
    Note over Client,AppError: Cache Error Handling
    
    Client->>MessageCatalogService: GetMessage(code, lang)
    Note over Client,MessageCatalogService: Request with cache enabled
    
    MessageCatalogService->>MessageCatalogService: Check cache
    Note over MessageCatalogService: Cache access fails (race condition)
    
    MessageCatalogService->>Logger: Log warning
    MessageCatalogService->>FileSystem: Fallback to file loading
    FileSystem-->>MessageCatalogService: Return file content
    
    MessageCatalogService->>MessageCatalogService: Process normally
    MessageCatalogService-->>Client: Return Message
